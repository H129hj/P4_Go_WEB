{{define "GamePlay"}}
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/static/css/style.css">
  <title>Puissance 4 - Jeu</title>
</head>
<body>
  <header>
    <h1>Puissance4</h1>
  </header>

  <main class="game-container">
    {{if .Error}}
      <div class="flash error">{{.Error}}</div>
    {{end}}

    {{if .Winner}}
      <div class="flash winner">Le joueur <strong>{{.Winner}}</strong> a gagn√© !</div>
    {{else}}
      <div class="turn">Au tour de : <strong>{{.CurrentPlayer}}</strong></div>
    {{end}}

    <section class="board-section">
      <table class="connect4" role="grid" aria-label="Grille Puissance 4">
        <caption class="visually-hidden">Grille de jeu</caption>
        {{/* .Grid : slice de lignes (de haut en bas), chaque ligne slice des colonnes */}}
        {{range $r := .Grid}}
          <tr>
            {{range $c := $r}}
              <td class="cell token-{{$c}}">
                {{if eq $c 1}}
                  <span class="disc red" aria-hidden="true"></span>
                {{else if eq $c 2}}
                  <span class="disc yellow" aria-hidden="true"></span>
                {{else}}
                  <span class="disc empty" aria-hidden="true"></span>
                {{end}}
              </td>
            {{end}}
          </tr>
        {{end}}
      </table>
    </section>

    {{if not .Winner}}
    <section class="controls">
      <form action="/game/play/traitement" method="POST" class="move-form">
        {{if .Game}}
          <input type="hidden" name="game_id" value="{{.Game.ID}}">
        {{end}}
        <label for="column">Colonne (1-7) :</label>
        <input id="column" name="column" type="number" min="1" max="7" required>
        <button type="submit" class="play-btn">Jouer</button>
      </form>
    </section>
    {{end}}

    <footer class="game-footer">
      <a href="/" class="start-btn">Retour</a>
    </footer>
  </main>
</body>
</html>
{{end}}
